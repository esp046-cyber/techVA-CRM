<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 techVA AI CRM - Tier 1+2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
            padding: 1%;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 1%;
            padding-bottom: 80px;
        }

        header {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 12px 1%;
            margin-bottom: 1%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        h1 {
            font-size: 1rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 4px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            font-size: 0.7rem;
            color: #a0a0a0;
            font-weight: 400;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1%;
            margin-bottom: 1%;
        }

        .stat-card {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            padding: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
            display: block;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 0.6rem;
            color: #b0b0b0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tabs {
            display: flex;
            gap: 1%;
            margin-bottom: 1%;
            background: rgba(255, 255, 255, 0.05);
            padding: 6px;
            border-radius: 12px;
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            min-width: 70px;
            padding: 8px;
            background: transparent;
            border: none;
            color: #a0a0a0;
            font-size: 0.7rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .add-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.5);
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .add-btn:active {
            transform: scale(0.95);
        }

        .contact-card, .deal-card, .task-card, .event-card, .product-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 1%;
            position: relative;
            overflow: hidden;
        }

        .contact-card::before, .deal-card::before, .task-card::before, .event-card::before, .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .contact-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .contact-name {
            font-size: 0.95rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 4px;
        }

        .contact-company {
            font-size: 0.75rem;
            color: #a0a0a0;
        }

        .contact-info {
            font-size: 0.7rem;
            color: #b0b0b0;
            margin: 4px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin: 8px 0;
        }

        .tag {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 8px;
            font-size: 0.6rem;
            font-weight: 600;
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-lead { background: rgba(255, 193, 7, 0.2); color: #ffc107; border: 1px solid rgba(255, 193, 7, 0.4); }
        .status-prospect { background: rgba(33, 150, 243, 0.2); color: #2196f3; border: 1px solid rgba(33, 150, 243, 0.4); }
        .status-customer { background: rgba(76, 175, 80, 0.2); color: #4caf50; border: 1px solid rgba(76, 175, 80, 0.4); }
        .status-negotiation { background: rgba(255, 152, 0, 0.2); color: #ff9800; border: 1px solid rgba(255, 152, 0, 0.4); }
        .status-closed { background: rgba(76, 175, 80, 0.2); color: #4caf50; border: 1px solid rgba(76, 175, 80, 0.4); }
        .status-lost { background: rgba(244, 67, 54, 0.2); color: #f44336; border: 1px solid rgba(244, 67, 54, 0.4); }
        .status-pending { background: rgba(255, 193, 7, 0.2); color: #ffc107; border: 1px solid rgba(255, 193, 7, 0.4); }
        .status-completed { background: rgba(76, 175, 80, 0.2); color: #4caf50; border: 1px solid rgba(76, 175, 80, 0.4); }

        .lead-score {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 700;
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.4);
        }

        .lead-score.hot { background: rgba(244, 67, 54, 0.2); color: #f44336; border-color: rgba(244, 67, 54, 0.4); }
        .lead-score.warm { background: rgba(255, 152, 0, 0.2); color: #ff9800; border-color: rgba(255, 152, 0, 0.4); }
        .lead-score.cold { background: rgba(33, 150, 243, 0.2); color: #2196f3; border-color: rgba(33, 150, 243, 0.4); }

        .deal-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
            margin: 8px 0;
        }

        .deal-info {
            font-size: 0.7rem;
            color: #b0b0b0;
            margin: 4px 0;
        }

        .action-btns {
            display: flex;
            gap: 6px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            min-width: 60px;
            padding: 7px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: #e0e0e0;
            border-radius: 8px;
            font-size: 0.65rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:active {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(0.98);
        }

        .btn-delete {
            background: rgba(244, 67, 54, 0.2);
            border-color: rgba(244, 67, 54, 0.4);
            color: #f44336;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            padding: 1%;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: linear-gradient(135deg, #1e1e2e 0%, #2d2d44 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            font-size: 1.1rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-label {
            display: block;
            font-size: 0.7rem;
            color: #a0a0a0;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-textarea {
            min-height: 70px;
            resize: vertical;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .form-select {
            cursor: pointer;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-primary {
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            flex: 1;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #e0e0e0;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #707070;
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 12px;
            opacity: 0.3;
        }

        .empty-text {
            font-size: 0.85rem;
        }

        .search-box {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #e0e0e0;
            font-size: 0.85rem;
            margin-bottom: 1%;
        }

        .search-box:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .toolbar {
            display: flex;
            gap: 6px;
            margin-bottom: 1%;
            flex-wrap: wrap;
        }

        .toolbar-btn {
            padding: 7px 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toolbar-btn:active {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(0.98);
        }

        .pipeline-board {
            display: flex;
            gap: 1%;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .pipeline-column {
            min-width: 260px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 12px;
        }

        .pipeline-header {
            font-size: 0.8rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .pipeline-count {
            background: rgba(102, 126, 234, 0.3);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.65rem;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 1%;
        }

        .chart-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 12px;
        }

        .chart-bar {
            margin-bottom: 10px;
        }

        .chart-label {
            font-size: 0.7rem;
            color: #a0a0a0;
            margin-bottom: 4px;
            display: flex;
            justify-content: space-between;
        }

        .chart-progress {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .chart-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-top: 10px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calendar-day.header {
            font-weight: 700;
            color: #a0a0a0;
            cursor: default;
        }

        .calendar-day.current {
            background: rgba(102, 126, 234, 0.3);
            color: #667eea;
            font-weight: 700;
        }

        .calendar-day.has-event {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }

        .calendar-day:not(.header):hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .attachment-list {
            margin-top: 8px;
        }

        .attachment-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 8px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 6px;
            margin-bottom: 6px;
            font-size: 0.7rem;
        }

        .workflow-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .workflow-trigger {
            font-size: 0.75rem;
            color: #667eea;
            margin-bottom: 6px;
        }

        .workflow-action {
            font-size: 0.7rem;
            color: #a0a0a0;
            padding-left: 12px;
            border-left: 2px solid rgba(102, 126, 234, 0.3);
        }

        .quote-section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
        }

        .quote-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 0.75rem;
        }

        .quote-item:last-child {
            border-bottom: none;
            font-weight: 700;
            color: #667eea;
        }

        input[type="file"] {
            display: none;
        }

        .file-upload-btn {
            padding: 8px 12px;
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.4);
            border-radius: 8px;
            color: #667eea;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
            display: inline-block;
        }

        .file-upload-btn:active {
            background: rgba(102, 126, 234, 0.3);
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 0.9rem;
            }
            
            .stat-value {
                font-size: 1rem;
            }
            
            .stat-label {
                font-size: 0.55rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .pipeline-column {
                min-width: 220px;
            }

            .tab {
                font-size: 0.65rem;
                padding: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>2026 techVA AI automation CRM Pro</h1>
            <div class="subtitle">Complete CRM Solution - Tier 1 + Tier 2</div>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-value" id="totalContacts">0</span>
                <span class="stat-label">Contacts</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="totalDeals">0</span>
                <span class="stat-label">Deals</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="conversionRate">0%</span>
                <span class="stat-label">Conv. Rate</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="totalValue">$0</span>
                <span class="stat-label">Pipeline</span>
            </div>
        </div>

        <input type="text" class="search-box" id="searchBox" placeholder="üîç Search...">

        <div class="toolbar">
            <button class="toolbar-btn" onclick="exportData()">üì§ Export</button>
            <label for="importFile" class="toolbar-btn">üì• Import</label>
            <input type="file" id="importFile" accept=".csv" onchange="importData(event)">
            <button class="toolbar-btn" onclick="openTemplatesModal()">‚úâÔ∏è Templates</button>
            <button class="toolbar-btn" onclick="openWorkflowsModal()">‚öôÔ∏è Workflows</button>
            <button class="toolbar-btn" onclick="openProductsModal()">üì¶ Products</button>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('contacts')">Contacts</button>
            <button class="tab" onclick="switchTab('deals')">Deals</button>
            <button class="tab" onclick="switchTab('pipeline')">Pipeline</button>
            <button class="tab" onclick="switchTab('tasks')">Tasks</button>
            <button class="tab" onclick="switchTab('calendar')">Calendar</button>
            <button class="tab" onclick="switchTab('analytics')">Analytics</button>
        </div>

        <div id="contactsTab" class="tab-content active">
            <div id="contactsList"></div>
        </div>

        <div id="dealsTab" class="tab-content">
            <div id="dealsList"></div>
        </div>

        <div id="pipelineTab" class="tab-content">
            <div class="pipeline-board" id="pipelineBoard"></div>
        </div>

        <div id="tasksTab" class="tab-content">
            <div id="tasksList"></div>
        </div>

        <div id="calendarTab" class="tab-content">
            <div id="calendarView"></div>
            <div id="eventsList" style="margin-top: 20px;"></div>
        </div>

        <div id="analyticsTab" class="tab-content">
            <div id="analyticsContent"></div>
        </div>
    </div>

    <button class="add-btn" onclick="openAddModal()">+</button>

    <!-- Modals placeholder -->
    <div id="contactModal" class="modal"></div>
    <div id="dealModal" class="modal"></div>
    <div id="taskModal" class="modal"></div>
    <div id="eventModal" class="modal"></div>
    <div id="noteModal" class="modal"></div>
    <div id="templatesModal" class="modal"></div>
    <div id="contactDetailModal" class="modal"></div>
    <div id="workflowsModal" class="modal"></div>
    <div id="productsModal" class="modal"></div>
    <div id="quoteModal" class="modal"></div>

    <script>
        // Data storage
        let contacts = [];
        let deals = [];
        let tasks = [];
        let events = [];
        let notes = [];
        let emailTemplates = [];
        let emailLogs = [];
        let attachments = [];
        let workflows = [];
        let products = [];
        let quotes = [];
        let currentTab = 'contacts';

        // Initialize sample data
        function initSampleData() {
            contacts = [
                {
                    id: 1,
                    name: 'Sarah Johnson',
                    email: 'sarah.j@techcorp.com',
                    phone: '+1 (555) 123-4567',
                    company: 'TechCorp Inc.',
                    status: 'customer',
                    tags: ['VIP', 'Tech'],
                    industry: 'Technology',
                    source: 'Referral',
                    score: 85,
                    interactions: 12,
                    lastContact: '2026-02-03',
                    history: [
                        { action: 'Contact created', date: '2026-01-15T10:30:00' },
                        { action: 'Email sent: Welcome', date: '2026-01-15T14:20:00' },
                        { action: 'Meeting scheduled', date: '2026-02-01T09:00:00' }
                    ]
                },
                {
                    id: 2,
                    name: 'Michael Chen',
                    email: 'mchen@innovate.io',
                    phone: '+1 (555) 987-6543',
                    company: 'Innovate Solutions',
                    status: 'prospect',
                    tags: ['Enterprise'],
                    industry: 'Software',
                    source: 'Website',
                    score: 65,
                    interactions: 5,
                    lastContact: '2026-02-02',
                    history: [
                        { action: 'Contact created', date: '2026-02-01T09:00:00' }
                    ]
                },
                {
                    id: 3,
                    name: 'Emily Rodriguez',
                    email: 'emily.r@startup.com',
                    phone: '+1 (555) 456-7890',
                    company: 'Startup Ventures',
                    status: 'lead',
                    tags: ['Startup'],
                    industry: 'Finance',
                    source: 'Event',
                    score: 45,
                    interactions: 2,
                    lastContact: '2026-02-04',
                    history: [
                        { action: 'Contact created', date: '2026-02-03T11:15:00' }
                    ]
                }
            ];

            deals = [
                {
                    id: 1,
                    name: 'Enterprise License Deal',
                    contact: 'Sarah Johnson',
                    value: 45000,
                    stage: 'negotiation',
                    closeDate: '2026-03-15',
                    tags: ['Enterprise', 'Q1'],
                    probability: 70
                },
                {
                    id: 2,
                    name: 'Cloud Migration Project',
                    contact: 'Michael Chen',
                    value: 32500,
                    stage: 'prospect',
                    closeDate: '2026-04-01',
                    tags: ['Cloud'],
                    probability: 40
                }
            ];

            tasks = [
                {
                    id: 1,
                    title: 'Follow up with Sarah',
                    description: 'Discuss contract terms',
                    related: 'Sarah Johnson',
                    dueDate: '2026-02-10',
                    priority: 'high',
                    status: 'pending'
                }
            ];

            events = [
                {
                    id: 1,
                    title: 'Meeting with Sarah',
                    date: '2026-02-08',
                    time: '14:00',
                    attendees: 'Sarah Johnson',
                    type: 'meeting',
                    location: 'Zoom'
                }
            ];

            emailTemplates = [
                {
                    id: 1,
                    name: 'Welcome Email',
                    subject: 'Welcome to 2026 techVA!',
                    body: 'Hi {{name}},\n\nWelcome aboard!\n\nBest,\nTeam'
                },
                {
                    id: 2,
                    name: 'Follow-up',
                    subject: 'Following up',
                    body: 'Hi {{name}},\n\nJust following up.\n\nBest'
                }
            ];

            workflows = [
                {
                    id: 1,
                    name: 'New Lead Workflow',
                    trigger: 'New contact with status "lead"',
                    actions: [
                        'Send welcome email',
                        'Create follow-up task (3 days)',
                        'Assign to sales team'
                    ],
                    active: true
                },
                {
                    id: 2,
                    name: 'Deal Won Workflow',
                    trigger: 'Deal stage changed to "closed"',
                    actions: [
                        'Send thank you email',
                        'Update contact status to "customer"',
                        'Create onboarding task'
                    ],
                    active: true
                }
            ];

            products = [
                {
                    id: 1,
                    name: 'Basic Plan',
                    description: 'Essential features for small teams',
                    price: 49,
                    unit: 'user/month'
                },
                {
                    id: 2,
                    name: 'Pro Plan',
                    description: 'Advanced features for growing businesses',
                    price: 99,
                    unit: 'user/month'
                },
                {
                    id: 3,
                    name: 'Enterprise Plan',
                    description: 'Full suite with custom solutions',
                    price: 299,
                    unit: 'user/month'
                }
            ];

            renderAll();
            updateStats();
        }

        function renderAll() {
            renderContacts();
            renderDeals();
            renderTasks();
            renderPipeline();
            renderCalendar();
            renderAnalytics();
        }

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            const tabs = ['contacts', 'deals', 'pipeline', 'tasks', 'calendar', 'analytics'];
            const index = tabs.indexOf(tab);
            document.querySelectorAll('.tab')[index].classList.add('active');
            document.getElementById(tab + 'Tab').classList.add('active');

            if (tab === 'pipeline') renderPipeline();
            if (tab === 'calendar') renderCalendar();
            if (tab === 'analytics') renderAnalytics();
        }

        function getScoreClass(score) {
            if (score >= 80) return 'hot';
            if (score >= 60) return 'warm';
            return 'cold';
        }

        function getScoreLabel(score) {
            if (score >= 80) return 'Hot';
            if (score >= 60) return 'Warm';
            return 'Cold';
        }

        function renderContacts(filter = '') {
            const contactsList = document.getElementById('contactsList');
            const filtered = contacts.filter(c => 
                c.name.toLowerCase().includes(filter.toLowerCase()) ||
                c.email.toLowerCase().includes(filter.toLowerCase()) ||
                c.company.toLowerCase().includes(filter.toLowerCase()) ||
                (c.tags && c.tags.some(tag => tag.toLowerCase().includes(filter.toLowerCase())))
            );

            if (filtered.length === 0) {
                contactsList.innerHTML = '<div class="empty-state"><div class="empty-icon">üë§</div><div class="empty-text">No contacts found</div></div>';
                return;
            }

            contactsList.innerHTML = filtered.map(contact => `
                <div class="contact-card">
                    <div class="contact-header">
                        <div>
                            <div class="contact-name">${contact.name}</div>
                            <div class="contact-company">${contact.company || 'No company'}</div>
                        </div>
                        <div style="display: flex; gap: 6px; flex-direction: column; align-items: flex-end;">
                            <span class="status-badge status-${contact.status}">${contact.status}</span>
                            <span class="lead-score ${getScoreClass(contact.score)}">‚≠ê ${contact.score} ${getScoreLabel(contact.score)}</span>
                        </div>
                    </div>
                    <div class="contact-info">üìß ${contact.email}</div>
                    <div class="contact-info">üì± ${contact.phone || 'No phone'}</div>
                    <div class="contact-info">üîÑ ${contact.interactions} interactions ‚Ä¢ Last: ${contact.lastContact}</div>
                    ${contact.tags ? `<div class="tags-container">${contact.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}</div>` : ''}
                    <div class="action-btns">
                        <button class="btn" onclick="viewContactDetail(${contact.id})">üëÅÔ∏è View</button>
                        <button class="btn" onclick="logEmail(${contact.id})">üìß Email</button>
                        <button class="btn" onclick="scheduleEvent(${contact.id})">üìÖ Meet</button>
                        <button class="btn" onclick="createQuote(${contact.id})">üí∞ Quote</button>
                        <button class="btn btn-delete" onclick="deleteContact(${contact.id})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function renderDeals(filter = '') {
            const dealsList = document.getElementById('dealsList');
            const filtered = deals.filter(d => 
                d.name.toLowerCase().includes(filter.toLowerCase()) ||
                d.contact.toLowerCase().includes(filter.toLowerCase())
            );

            if (filtered.length === 0) {
                dealsList.innerHTML = '<div class="empty-state"><div class="empty-icon">üíº</div><div class="empty-text">No deals found</div></div>';
                return;
            }

            dealsList.innerHTML = filtered.map(deal => `
                <div class="deal-card">
                    <div class="contact-header">
                        <div>
                            <div class="contact-name">${deal.name}</div>
                            <div class="contact-company">${deal.contact}</div>
                        </div>
                        <span class="status-badge status-${deal.stage}">${deal.stage}</span>
                    </div>
                    <div class="deal-value">$${deal.value.toLocaleString()}</div>
                    <div class="deal-info">üìÖ Close: ${deal.closeDate || 'Not set'}</div>
                    <div class="deal-info">üìä Win Probability: ${deal.probability}%</div>
                    ${deal.tags ? `<div class="tags-container">${deal.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}</div>` : ''}
                    <div class="action-btns">
                        <button class="btn" onclick="createQuoteForDeal(${deal.id})">üí∞ Quote</button>
                        <button class="btn" onclick="moveDealStage(${deal.id})">‚û°Ô∏è Move</button>
                        <button class="btn btn-delete" onclick="deleteDeal(${deal.id})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function renderTasks(filter = '') {
            const tasksList = document.getElementById('tasksList');
            const filtered = tasks.filter(t => 
                t.title.toLowerCase().includes(filter.toLowerCase())
            );

            if (filtered.length === 0) {
                tasksList.innerHTML = '<div class="empty-state"><div class="empty-icon">‚úì</div><div class="empty-text">No tasks</div></div>';
                return;
            }

            tasksList.innerHTML = filtered.map(task => `
                <div class="task-card">
                    <div class="contact-header">
                        <div>
                            <div class="contact-name">${task.title}</div>
                            <div class="contact-company">${task.related || 'No relation'}</div>
                        </div>
                        <span class="status-badge status-${task.status}">${task.status}</span>
                    </div>
                    <div class="deal-info">üìÖ ${task.dueDate}</div>
                    <div class="action-btns">
                        <button class="btn" onclick="toggleTaskStatus(${task.id})">${task.status === 'pending' ? '‚úì Complete' : '‚Ü∫ Reopen'}</button>
                        <button class="btn btn-delete" onclick="deleteTask(${task.id})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function renderPipeline() {
            const pipelineBoard = document.getElementById('pipelineBoard');
            const stages = ['lead', 'prospect', 'negotiation', 'closed'];
            const stageLabels = { lead: 'Lead', prospect: 'Prospect', negotiation: 'Negotiation', closed: 'Closed Won' };

            pipelineBoard.innerHTML = stages.map(stage => {
                const stageDeals = deals.filter(d => d.stage === stage);
                const stageValue = stageDeals.reduce((sum, d) => sum + d.value, 0);
                return `
                    <div class="pipeline-column">
                        <div class="pipeline-header">
                            <span>${stageLabels[stage]}</span>
                            <span class="pipeline-count">${stageDeals.length}</span>
                        </div>
                        <div style="font-size: 0.7rem; color: #a0a0a0; margin-bottom: 10px;">$${stageValue.toLocaleString()}</div>
                        ${stageDeals.map(deal => `
                            <div class="deal-card" style="margin-bottom: 10px;">
                                <div class="contact-name">${deal.name}</div>
                                <div class="contact-company">${deal.contact}</div>
                                <div class="deal-value" style="font-size: 1rem;">$${deal.value.toLocaleString()}</div>
                                <div class="deal-info">${deal.probability}% prob</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }).join('');
        }

        function renderCalendar() {
            const calendarView = document.getElementById('calendarView');
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = now.getDate();

            const eventDates = events.map(e => new Date(e.date).getDate());

            let calendarHTML = '<div class="chart-container">';
            calendarHTML += `<div class="chart-title">${now.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</div>`;
            calendarHTML += '<div class="calendar-grid">';
            
            ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].forEach(day => {
                calendarHTML += `<div class="calendar-day header">${day}</div>`;
            });

            for (let i = 0; i < firstDay; i++) {
                calendarHTML += '<div class="calendar-day"></div>';
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const classes = ['calendar-day'];
                if (day === today) classes.push('current');
                if (eventDates.includes(day)) classes.push('has-event');
                calendarHTML += `<div class="${classes.join(' ')}">${day}</div>`;
            }

            calendarHTML += '</div></div>';
            calendarView.innerHTML = calendarHTML;

            // Render events list
            const eventsList = document.getElementById('eventsList');
            if (events.length === 0) {
                eventsList.innerHTML = '<div class="empty-state"><div class="empty-icon">üìÖ</div><div class="empty-text">No events scheduled</div></div>';
            } else {
                eventsList.innerHTML = events.map(event => `
                    <div class="event-card">
                        <div class="contact-name">${event.title}</div>
                        <div class="deal-info">üìÖ ${event.date} at ${event.time}</div>
                        <div class="deal-info">üë• ${event.attendees}</div>
                        <div class="deal-info">üìç ${event.location}</div>
                        <div class="action-btns">
                            <button class="btn btn-delete" onclick="deleteEvent(${event.id})">üóëÔ∏è Delete</button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function renderAnalytics() {
            const analyticsContent = document.getElementById('analyticsContent');
            
            // Calculate metrics
            const totalLeads = contacts.filter(c => c.status === 'lead').length;
            const totalCustomers = contacts.filter(c => c.status === 'customer').length;
            const conversionRate = totalLeads > 0 ? ((totalCustomers / (totalLeads + totalCustomers)) * 100).toFixed(1) : 0;
            
            const closedDeals = deals.filter(d => d.stage === 'closed').length;
            const totalDealsCount = deals.length;
            const dealConversionRate = totalDealsCount > 0 ? ((closedDeals / totalDealsCount) * 100).toFixed(1) : 0;
            
            const avgDealValue = deals.length > 0 ? (deals.reduce((sum, d) => sum + d.value, 0) / deals.length).toFixed(0) : 0;
            const forecastRevenue = deals.reduce((sum, d) => sum + (d.value * d.probability / 100), 0).toFixed(0);

            analyticsContent.innerHTML = `
                <div class="chart-container">
                    <div class="chart-title">Key Metrics</div>
                    <div class="chart-bar">
                        <div class="chart-label">
                            <span>Conversion Rate</span>
                            <span>${conversionRate}%</span>
                        </div>
                        <div class="chart-progress">
                            <div class="chart-fill" style="width: ${conversionRate}%"></div>
                        </div>
                    </div>
                    <div class="chart-bar">
                        <div class="chart-label">
                            <span>Deal Win Rate</span>
                            <span>${dealConversionRate}%</span>
                        </div>
                        <div class="chart-progress">
                            <div class="chart-fill" style="width: ${dealConversionRate}%"></div>
                        </div>
                    </div>
                    <div class="chart-bar">
                        <div class="chart-label">
                            <span>Avg Deal Value</span>
                            <span>$${Number(avgDealValue).toLocaleString()}</span>
                        </div>
                    </div>
                    <div class="chart-bar">
                        <div class="chart-label">
                            <span>Forecast Revenue</span>
                            <span>$${Number(forecastRevenue).toLocaleString()}</span>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Lead Score Distribution</div>
                    ${['Hot (80+)', 'Warm (60-79)', 'Cold (<60)'].map((label, idx) => {
                        const ranges = [[80, 100], [60, 79], [0, 59]];
                        const count = contacts.filter(c => c.score >= ranges[idx][0] && c.score <= ranges[idx][1]).length;
                        const percent = contacts.length > 0 ? (count / contacts.length * 100).toFixed(0) : 0;
                        return `
                            <div class="chart-bar">
                                <div class="chart-label">
                                    <span>${label}</span>
                                    <span>${count} (${percent}%)</span>
                                </div>
                                <div class="chart-progress">
                                    <div class="chart-fill" style="width: ${percent}%"></div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>

                <div class="chart-container">
                    <div class="chart-title">Pipeline by Stage</div>
                    ${['lead', 'prospect', 'negotiation', 'closed'].map(stage => {
                        const stageDeals = deals.filter(d => d.stage === stage);
                        const value = stageDeals.reduce((sum, d) => sum + d.value, 0);
                        const maxValue = Math.max(...['lead', 'prospect', 'negotiation', 'closed'].map(s => 
                            deals.filter(d => d.stage === s).reduce((sum, d) => sum + d.value, 0)
                        ));
                        const percent = maxValue > 0 ? (value / maxValue * 100).toFixed(0) : 0;
                        return `
                            <div class="chart-bar">
                                <div class="chart-label">
                                    <span>${stage.charAt(0).toUpperCase() + stage.slice(1)}</span>
                                    <span>$${value.toLocaleString()}</span>
                                </div>
                                <div class="chart-progress">
                                    <div class="chart-fill" style="width: ${percent}%"></div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function updateStats() {
            document.getElementById('totalContacts').textContent = contacts.length;
            document.getElementById('totalDeals').textContent = deals.length;
            
            const totalLeads = contacts.filter(c => c.status === 'lead').length;
            const totalCustomers = contacts.filter(c => c.status === 'customer').length;
            const conversionRate = totalLeads > 0 ? ((totalCustomers / (totalLeads + totalCustomers)) * 100).toFixed(0) : 0;
            document.getElementById('conversionRate').textContent = conversionRate + '%';
            
            const totalValue = deals.reduce((sum, d) => d.stage !== 'lost' ? sum + d.value : sum, 0);
            document.getElementById('totalValue').textContent = '$' + totalValue.toLocaleString();
        }

        // Quick action functions
        function logEmail(contactId) {
            const contact = contacts.find(c => c.id === contactId);
            if (!contact) return;
            
            const template = emailTemplates[0];
            if (confirm(`Send "${template.subject}" to ${contact.name}?`)) {
                contact.interactions++;
                contact.score = Math.min(100, contact.score + 5);
                contact.lastContact = new Date().toISOString().split('T')[0];
                contact.history.push({
                    action: `Email sent: ${template.subject}`,
                    date: new Date().toISOString()
                });
                renderContacts();
                updateStats();
                alert('Email logged successfully!');
            }
        }

        function scheduleEvent(contactId) {
            const contact = contacts.find(c => c.id === contactId);
            if (!contact) return;
            
            const date = prompt('Meeting date (YYYY-MM-DD):');
            if (!date) return;
            
            const time = prompt('Meeting time (HH:MM):');
            if (!time) return;

            events.push({
                id: events.length > 0 ? Math.max(...events.map(e => e.id)) + 1 : 1,
                title: `Meeting with ${contact.name}`,
                date: date,
                time: time,
                attendees: contact.name,
                type: 'meeting',
                location: 'TBD'
            });

            contact.interactions++;
            contact.score = Math.min(100, contact.score + 10);
            
            renderCalendar();
            renderContacts();
            updateStats();
            alert('Event scheduled!');
        }

        function createQuote(contactId) {
            const contact = contacts.find(c => c.id === contactId);
            if (!contact) return;
            
            showQuoteModal(contact);
        }

        function showQuoteModal(contact) {
            const modal = document.getElementById('quoteModal');
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">Create Quote for ${contact.name}</div>
                    <div style="margin-bottom: 20px;">
                        <div class="form-label">Select Products</div>
                        ${products.map(p => `
                            <div style="margin-bottom: 10px;">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                    <input type="checkbox" class="product-checkbox" data-product-id="${p.id}" data-price="${p.price}">
                                    <span style="flex: 1;">
                                        <strong>${p.name}</strong> - $${p.price}/${p.unit}
                                        <br><span style="font-size: 0.7rem; color: #a0a0a0;">${p.description}</span>
                                    </span>
                                </label>
                                <input type="number" min="1" value="1" class="form-input" id="qty-${p.id}" placeholder="Qty" style="margin-top: 6px; max-width: 100px;">
                            </div>
                        `).join('')}
                    </div>
                    <div class="quote-section" id="quotePreview" style="display: none;">
                        <div style="font-size: 0.8rem; font-weight: 700; margin-bottom: 10px;">Quote Preview</div>
                        <div id="quoteItems"></div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeModal()">Cancel</button>
                        <button type="button" class="btn-primary" onclick="generateQuote(${contact.id})">Generate Quote</button>
                    </div>
                </div>
            `;
            modal.classList.add('active');

            // Add event listeners
            document.querySelectorAll('.product-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', updateQuotePreview);
            });
        }

        function updateQuotePreview() {
            const selectedProducts = [];
            document.querySelectorAll('.product-checkbox:checked').forEach(checkbox => {
                const productId = parseInt(checkbox.dataset.productId);
                const product = products.find(p => p.id === productId);
                const qty = parseInt(document.getElementById(`qty-${productId}`).value) || 1;
                selectedProducts.push({ ...product, qty });
            });

            const preview = document.getElementById('quotePreview');
            const itemsDiv = document.getElementById('quoteItems');
            
            if (selectedProducts.length === 0) {
                preview.style.display = 'none';
                return;
            }

            preview.style.display = 'block';
            let total = 0;
            itemsDiv.innerHTML = selectedProducts.map(p => {
                const subtotal = p.price * p.qty;
                total += subtotal;
                return `
                    <div class="quote-item">
                        <span>${p.name} (${p.qty}x)</span>
                        <span>$${subtotal.toLocaleString()}</span>
                    </div>
                `;
            }).join('') + `
                <div class="quote-item">
                    <span>TOTAL</span>
                    <span>$${total.toLocaleString()}</span>
                </div>
            `;
        }

        function generateQuote(contactId) {
            const selectedProducts = [];
            document.querySelectorAll('.product-checkbox:checked').forEach(checkbox => {
                const productId = parseInt(checkbox.dataset.productId);
                const product = products.find(p => p.id === productId);
                const qty = parseInt(document.getElementById(`qty-${productId}`).value) || 1;
                selectedProducts.push({ ...product, qty });
            });

            if (selectedProducts.length === 0) {
                alert('Please select at least one product');
                return;
            }

            const total = selectedProducts.reduce((sum, p) => sum + (p.price * p.qty), 0);
            
            quotes.push({
                id: quotes.length + 1,
                contactId: contactId,
                products: selectedProducts,
                total: total,
                date: new Date().toISOString().split('T')[0],
                status: 'sent'
            });

            const contact = contacts.find(c => c.id === contactId);
            if (contact) {
                contact.history.push({
                    action: `Quote generated: $${total.toLocaleString()}`,
                    date: new Date().toISOString()
                });
                contact.score = Math.min(100, contact.score + 15);
            }

            alert(`Quote generated successfully!\nTotal: $${total.toLocaleString()}`);
            closeModal();
            renderContacts();
        }

        function openWorkflowsModal() {
            const modal = document.getElementById('workflowsModal');
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">Automated Workflows</div>
                    ${workflows.map(w => `
                        <div class="workflow-card">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <strong style="color: #fff;">${w.name}</strong>
                                <span class="status-badge ${w.active ? 'status-completed' : 'status-pending'}">${w.active ? 'Active' : 'Inactive'}</span>
                            </div>
                            <div class="workflow-trigger">‚ö° Trigger: ${w.trigger}</div>
                            <div class="workflow-action">
                                ${w.actions.map(a => `‚Ä¢ ${a}`).join('<br>')}
                            </div>
                        </div>
                    `).join('')}
                    <div class="form-actions">
                        <button type="button" class="btn-primary" onclick="closeModal()">Close</button>
                    </div>
                </div>
            `;
            modal.classList.add('active');
        }

        function openProductsModal() {
            const modal = document.getElementById('productsModal');
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">Product Catalog</div>
                    ${products.map(p => `
                        <div class="product-card">
                            <div class="contact-name">${p.name}</div>
                            <div class="deal-info">${p.description}</div>
                            <div class="deal-value" style="font-size: 1rem; margin-top: 8px;">$${p.price}/${p.unit}</div>
                        </div>
                    `).join('')}
                    <div class="form-actions">
                        <button type="button" class="btn-primary" onclick="closeModal()">Close</button>
                    </div>
                </div>
            `;
            modal.classList.add('active');
        }

        function openTemplatesModal() {
            const modal = document.getElementById('templatesModal');
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">Email Templates</div>
                    ${emailTemplates.map(t => `
                        <div class="template-item" style="padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px; margin-bottom: 8px;">
                            <div style="font-weight: 700; color: #fff; margin-bottom: 4px;">${t.name}</div>
                            <div style="font-size: 0.75rem; color: #a0a0a0;">Subject: ${t.subject}</div>
                        </div>
                    `).join('')}
                    <div class="form-actions">
                        <button type="button" class="btn-primary" onclick="closeModal()">Close</button>
                    </div>
                </div>
            `;
            modal.classList.add('active');
        }

        function openAddModal() {
            alert('Add modal for ' + currentTab);
        }

        function viewContactDetail(id) {
            alert('View contact ' + id);
        }

        function moveDealStage(id) {
            const deal = deals.find(d => d.id === id);
            if (!deal) return;
            const stages = ['lead', 'prospect', 'negotiation', 'closed'];
            const idx = stages.indexOf(deal.stage);
            deal.stage = stages[(idx + 1) % stages.length];
            renderAll();
        }

        function toggleTaskStatus(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.status = task.status === 'pending' ? 'completed' : 'pending';
                renderTasks();
            }
        }

        function deleteContact(id) {
            if (confirm('Delete this contact?')) {
                contacts = contacts.filter(c => c.id !== id);
                renderContacts();
                updateStats();
            }
        }

        function deleteDeal(id) {
            if (confirm('Delete this deal?')) {
                deals = deals.filter(d => d.id !== id);
                renderAll();
                updateStats();
            }
        }

        function deleteTask(id) {
            if (confirm('Delete this task?')) {
                tasks = tasks.filter(t => t.id !== id);
                renderTasks();
            }
        }

        function deleteEvent(id) {
            if (confirm('Delete this event?')) {
                events = events.filter(e => e.id !== id);
                renderCalendar();
            }
        }

        function closeModal() {
            document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
        }

        function exportData() {
            alert('Export functionality');
        }

        function importData(e) {
            alert('Import functionality');
        }

        document.getElementById('searchBox').addEventListener('input', (e) => {
            const filter = e.target.value;
            if (currentTab === 'contacts') renderContacts(filter);
            else if (currentTab === 'deals') renderDeals(filter);
            else if (currentTab === 'tasks') renderTasks(filter);
        });

        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) closeModal();
        });

        initSampleData();
    </script>
</body>
</html>
